{% extends 'quiz/base.html' %}

{% block head %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">
	function ajusta_rodada(){
		$.post("{{ url_for('quiz_rodada') }}")
			.done(function(data){
				$("#rodada").text("RODADA " + data.partida['rodada']);
				$("#cartas").text("Cartas (" + data.partida['cartas'] + ")");
				$("#pulos").text("Pular (" + data.partida['pular'] + ")");

				$("#questao-enunciado").text(data.questao['enunciado']);
				$("#alternativa_a").text(data.questao['alternativa_a']);
				$("#alternativa_b").text(data.questao['alternativa_b']);
				$("#alternativa_c").text(data.questao['alternativa_c']);
				$("#alternativa_d").text(data.questao['alternativa_d']);
				$("#alternativa_e").text(data.questao['alternativa_e']);
				//alert(data.questao['enviado_por']);
				//alert(data.questao['enviado_por']);
				$("#enviado-por").text(data.questao['enviada_por']);
				$("#revisado-por").text(data.questao['revisada_por']);

				$("input:radio[name=alternativa][value=a]").prop('checked', true);
			})
			.fail(function(fail){
				alert('error');
			});
	}
	function envia_resposta(){
		var resposta = $('input:radio[name=alternativa]:checked').val();
		$.post("{{ url_for('quiz_responder') }}", {'resposta': resposta,})
			.done(function(data){
				var acertou = data['acertou'];
				if(acertou){
					ajusta_rodada();
				}else{
					window.location.replace("{{ url_for('quiz_resultado') }}");
				}
			})
			.fail(function(fail){
				alert('error');
			});
	}
	$(document).ready(function(){
		ajusta_rodada();

		$("#responder").bind('click', function(){
			envia_resposta();
		});

		$("#pular").bind('click', function(){
			$.post("{{ url_for('quiz_pular') }}")
				.done(function(data){
					var acertou = data['acertou'];
					if(acertou){
						ajusta_rodada();
					}else{
						window.location.replace("{{ url_for('quiz_resultado') }}");
					}
				})
				.fail(function(fail){
					alert('error');
				});
			ajusta_rodada();
		});

		/*qndo a page atualizar*/
		$(document).ready(function(){
			ajusta_rodada();
			//alert($('#'));
		});
	});
</script>
{% endblock %}

{% block quiz %}

<div id="questao-menu">
	<p id="rodada">RODADA X</p>
	<ul class="list-left">
		<li><a href="#" id="cartas">Cartas (X)</a></li>
		<li><a href="#" id="pular">Pular (X)</a></li>
	</ul>
</div>

<ul id="questao">
	<li>
		<p id="questao-enunciado" class="enunciado"></p>
	</li>
	<li id="alternativas">
		<ul>
			<li><input checked type="radio" name="alternativa" value="a"/>
				<label id="alternativa_a" for="alternativa_a"></label></li>
			<li><input type="radio" name="alternativa" value="b"/>
				<label id="alternativa_b" for="alternativa_b"></label></li>
			<li><input type="radio" name="alternativa" value="c"/>
				<label id="alternativa_c" for="alternativa_c"></label></li>
			<li><input type="radio" name="alternativa" value="d"/>
				<label id="alternativa_d" for="alternativa_d"></label></li>
			<li><input type="radio" name="alternativa" value="e"/>
				<label id="alternativa_e" for="alternativa_e"></label></li>
			<li><input type="button" id="responder" class="btn center" value="Responder" /></li>
			<li><p class="right copyright">enviado por <span class="a" id="enviado-por"></span> - revisado por <span class="a" id="revisado-por"></span></p></li>
		</ul>
	</li>
</ul>

{% endblock %}